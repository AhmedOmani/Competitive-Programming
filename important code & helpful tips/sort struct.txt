#include <bits/stdc++.h>
#define all(v) v.begin() , v.end()
using namespace std;

using ll = long long;

ll gcd(ll a, ll b) { return ((b == 0) ? a : gcd(b, a % b)); }
ll lcm(ll a, ll b) { return (b / gcd(a, b)) * a; }


void Omani () {
ios::sync_with_stdio(0); cin.tie(0), cout.tie(0);
#ifndef ONLINE_JUDGE
freopen("input.txt", "r", stdin);
#endif
}

struct info {

  int x , w ,i ;
  info() = default ;
  info (int x , int w , int i )
  : x(x) , w(w) , i (i) {}

};

void Solve() {

int n , m ;                                      cin >> n >> m ;

vector < info > v ;

for (int i = 0 ; i  < m ; i++) {

    int x , w ;                                  cin >> x >> w ;
    
    v.emplace_back( x , w , i + 1 ) ;

}

int sum = 0 ;

sort( all(v) , [](auto& a , auto& b) { return a.w < b.w ; });

vector < pair < int , int >> ans ;

for (int i = 0 ;  i < 2 * n ; i++) {

    sum += v[i].w ;

    ans.push_back( { v[i].x , v[i].i } ) ;
}

sort(all(ans)) ;

cout << sum << endl ;

for (int i = 0 , j = n * 2 - 1 ; i < j ; i++ , j--) 
    cout << ans[i].second << ' ' << ans[j].second << endl ;


}


int main()
{
Omani() ;
int T = 1 ;                                    cin >> T ;
while(T--) { Solve() ;}
}
